.. _kafka-sink:

==========================
Kafka Sink Connector Guide
==========================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol


Overview
--------

The MongoDB Kafka Sink Connector consumes records from a Kafka topic and
saves the data to a MongoDB database.

This section of the guide covers the configuration settings necessary to
set up a Kafka Sink connector.

.. admonition:: Add Indexes to Your Collections for Consistent Performance
   :class: important

   Writes performed by the Kafka Sink Connector take additional
   time to complete as the size of the underlying MongoDB collection
   grows. To prevent performance deterioration,
   :manual:`use an index to support these queries
   <tutorial/create-indexes-to-support-queries/>`.


Message Delivery Guarantee
--------------------------

The Sink Connector guarantees "at-least-once" message delivery by default.
If there is an error while processing data from a topic, the connector
retries the write.

An "exactly-once" message delivery guarantee can be achieved using an
idempotent operation such as insert or update. Configure the connector to
ensure messages include a value for the ``_id`` field.

.. note::

   You can configure the :ref:`DocumentIdAdder post processor <config-document-id-adder>`
   to define a custom behavior and a value for a ``_id`` field. By default,
   the sink connector uses the ``BsonOidStrategy`` which generates a
   new :manual:`BSON ObjectId </reference/bson-types/#objectid>` for the
   ``_id`` field if one does not exist.

If you need an "exactly-once" message delivery guarantee, configure the
connector to ensure messages include a value for the ``_id`` field. For
example, you can specify the :ref:`DocumentIdAdder post processor <config-document-id-adder>`
to add a value for the ``_id`` field.

The sink connector does not support the "at-most-once" guarantee.

.. toctree::
   :titlesonly:
   :hidden:

   Sink Configuration Properties </kafka-sink-properties>
   Sink Data Formats </kafka-sink-data-formats>
   Sink Post-Processors </kafka-sink-postprocessors>
   Sink Change Data Capture </kafka-sink-cdc>
